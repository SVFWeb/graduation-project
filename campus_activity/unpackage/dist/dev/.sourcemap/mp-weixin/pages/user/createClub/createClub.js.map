{"version":3,"file":"createClub.js","sources":["pages/user/createClub/createClub.vue","D:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdXNlci9jcmVhdGVDbHViL2NyZWF0ZUNsdWIudnVl"],"sourcesContent":["<template>\r\n\t<view class=\"create-club container\">\r\n\t\t<view class=\"form-container\">\r\n\t\t\t<uni-forms ref=\"formRef\" :modelValue=\"form\" :rules=\"rules\" label-position=\"top\" label-width=\"120\"\r\n\t\t\t\tvalidate-trigger=\"bind\">\r\n\t\t\t\t<!-- 图片上传 -->\r\n\t\t\t\t<uni-forms-item label=\"社团图标\" name=\"iconUrl\" required>\r\n\t\t\t\t\t<uni-file-picker v-model=\"form.iconUrl\" fileMediatype=\"image\" limit=\"1\" :auto-upload=\"false\"\r\n\t\t\t\t\t\tmode=\"grid\" title=\"上传图标\" @select=\"select\" />\r\n\t\t\t\t</uni-forms-item>\r\n\r\n\t\t\t\t<!-- 社团名称 -->\r\n\t\t\t\t<uni-forms-item label=\"社团名称\" name=\"name\" required>\r\n\t\t\t\t\t<input class=\"input\" type=\"text\" v-model=\"form.name\" placeholder=\"请输入社团名称\" maxlength=\"50\" />\r\n\t\t\t\t</uni-forms-item>\r\n\r\n\t\t\t\t<!-- 社团简介 -->\r\n\t\t\t\t<uni-forms-item label=\"社团简介\" name=\"description\" required>\r\n\t\t\t\t\t<textarea class=\"textarea\" v-model=\"form.description\" placeholder=\"请输入社团简介\" maxlength=\"500\"\r\n\t\t\t\t\t\t:auto-height=\"true\" />\r\n\t\t\t\t\t<view class=\"char-count\">{{ form.description.length }}/500</view>\r\n\t\t\t\t</uni-forms-item>\r\n\r\n\t\t\t\t<!-- 社团标签 -->\r\n\t\t\t\t<uni-forms-item label=\"社团标签\" name=\"tags\" required>\r\n\t\t\t\t\t<view class=\"tags-container\">\r\n\t\t\t\t\t\t<uni-tag v-for=\"(tag, index) in availableTags\" :key=\"index\" :text=\"tag\"\r\n\t\t\t\t\t\t\t:type=\"isTagSelected(tag) ? 'primary' : 'default'\" :inverted=\"!isTagSelected(tag)\"\r\n\t\t\t\t\t\t\t@click=\"toggleTag(tag)\" class=\"tag-item\" />\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"tip-text\">请至少选择1个标签</view>\r\n\t\t\t\t</uni-forms-item>\r\n\t\t\t</uni-forms>\r\n\r\n\t\t\t<!-- 提交按钮 -->\r\n\t\t\t<button class=\"submit-btn\" type=\"primary\" @click=\"handleSubmit\">提交</button>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tref,\r\n\t\treactive\r\n\t} from 'vue'\r\n\timport convertCloudPath from '@/utils/convertCloudPath'\r\n\timport {\r\n\t\tapiCreateClub\r\n\t} from '@/api/club/index.js'\r\n\r\n\t// 可用的标签列表\r\n\tconst availableTags = ['班级', '学院', '班级团支部', '音乐', '文艺', '传媒', '社团与协会', '公益志愿']\r\n\tconst formRef = ref(null)\r\n\tconst form = reactive({\r\n\t\ticonUrl: [],\r\n\t\tname: '',\r\n\t\tdescription: '',\r\n\t\ttags: []\r\n\t})\r\n\tconst coverImageUrl = ref('')\r\n\tconst filesName = ref('')\r\n\tconst filePath = ref('')\r\n\r\n\t// 判断标签是否被选中\r\n\tfunction isTagSelected(tagValue) {\r\n\t\treturn form.tags.includes(tagValue)\r\n\t}\r\n\r\n\t// 切换标签选中状态\r\n\tfunction toggleTag(tagValue) {\r\n\t\tconst index = form.tags.indexOf(tagValue)\r\n\t\tif (index > -1) {\r\n\t\t\t// 取消选中\r\n\t\t\tform.tags.splice(index, 1)\r\n\t\t} else {\r\n\t\t\t// 选中\r\n\t\t\tform.tags.push(tagValue)\r\n\t\t}\r\n\t}\r\n\r\n\t// 表单验证规则\r\n\tconst rules = {\r\n\t\ticonUrl: {\r\n\t\t\trequired: true,\r\n\t\t\terrorMessage: '请上传封面图片',\r\n\t\t\tvalidator: (rule, value, callback) => {\r\n\t\t\t\tif (!Array.isArray(value) || value.length < 1) {\r\n\t\t\t\t\tcallback('请至少上传1张封面图片')\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tcallback()\r\n\t\t\t}\r\n\t\t},\r\n\t\tname: {\r\n\t\t\trequired: true,\r\n\t\t\terrorMessage: '请输入活动名称'\r\n\t\t},\r\n\t\tdescription: {\r\n\t\t\trequired: true,\r\n\t\t\terrorMessage: '请输入活动简介',\r\n\t\t\tvalidator: (rule, value, callback) => {\r\n\t\t\t\tif (!value || value.trim().length === 0) {\r\n\t\t\t\t\tcallback('请输入活动简介')\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tif (value.length < 10) {\r\n\t\t\t\t\tcallback('活动简介至少需要10个字符')\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tcallback()\r\n\t\t\t}\r\n\t\t},\r\n\t\ttags: {\r\n\t\t\trequired: true,\r\n\t\t\terrorMessage: '请至少选择1个标签',\r\n\t\t\tvalidator: (rule, value, callback) => {\r\n\t\t\t\tif (!Array.isArray(value) || value.length < 1) {\r\n\t\t\t\t\tcallback('请至少选择1个标签')\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tcallback()\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t//\r\n\tfunction select(e) {\r\n\t\tcoverImageUrl.value = e.tempFilePaths[0]\r\n\t\tfilesName.value = e.tempFiles[0].name\r\n\t}\r\n\r\n\t// 提交表单\r\n\tasync function handleSubmit() {\r\n\t\tformRef.value\r\n\t\t\t.validate()\r\n\t\t\t.then(async () => {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: '提交中...'\r\n\t\t\t\t})\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\t// 如果有图片，先上传图片\r\n\t\t\t\t\tif (coverImageUrl.value) {\r\n\t\t\t\t\t\tawait new Promise((resolve, reject) => {\r\n\t\t\t\t\t\t\tuniCloud.uploadFile({\r\n\t\t\t\t\t\t\t\tfilePath: coverImageUrl.value,\r\n\t\t\t\t\t\t\t\tcloudPath: `club/${new Date().getTime()}_${filesName.value}`,\r\n\t\t\t\t\t\t\t\tfileType: 'image',\r\n\t\t\t\t\t\t\t\tsuccess: (e) => {\r\n\t\t\t\t\t\t\t\t\tfilePath.value = convertCloudPath(e.fileID)\r\n\t\t\t\t\t\t\t\t\tresolve()\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// 构建提交数据\r\n\t\t\t\t\tconst formData = {\r\n\t\t\t\t\t\tname: form.name,\r\n\t\t\t\t\t\tdescription: form.description || undefined,\r\n\t\t\t\t\t\ttags: form.tags.length > 0 ? form.tags.join(',') : undefined\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// 如果有上传的图片，添加 iconUrl\r\n\t\t\t\t\tif (filePath.value) {\r\n\t\t\t\t\t\tformData.iconUrl = filePath.value\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// 调用 API 创建社团\r\n\t\t\t\t\tconst res = await apiCreateClub(formData)\r\n\t\t\t\t\tuni.hideLoading()\r\n\r\n\t\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '创建成功',\r\n\t\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// 延迟返回上一页\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tuni.navigateBack()\r\n\t\t\t\t\t\t}, 1500)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: res.message || '创建失败',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '创建失败',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t\tconsole.error('创建社团失败', e)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.catch((err) => {\r\n\t\t\t\tconsole.warn('表单校验未通过', err)\r\n\t\t\t})\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t$primary-color: #FCB857;\r\n\t$bg-color: #F8F9FA;\r\n\t$text-primary: #333333;\r\n\t$text-secondary: #666666;\r\n\t$text-light: #999999;\r\n\t$border-color: #F0F0F0;\r\n\t$white: #FFFFFF;\r\n\r\n\t.create-club {\r\n\t\tbackground: $bg-color;\r\n\t\tmin-height: 100vh;\r\n\t\tpadding: 0;\r\n\t}\r\n\r\n\t.form-container {\r\n\t\tbackground: $white;\r\n\t\tborder-radius: 20rpx;\r\n\t\tmargin: 30rpx;\r\n\t\tpadding: 40rpx 32rpx;\r\n\t\tbox-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.04);\r\n\t\tborder: 1rpx solid $border-color;\r\n\t}\r\n\r\n\t.input {\r\n\t\twidth: 100%;\r\n\t\theight: 88rpx;\r\n\t\tbackground: #fafafa;\r\n\t\tborder-radius: 8rpx;\r\n\t\tpadding: 0 24rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: $text-primary;\r\n\t\tbox-sizing: border-box;\r\n\t\tborder: 1rpx solid $border-color;\r\n\t\ttransition: all 0.3s ease;\r\n\r\n\t\t&::placeholder {\r\n\t\t\tcolor: $text-light;\r\n\t\t}\r\n\t}\r\n\r\n\t.textarea {\r\n\t\twidth: 100%;\r\n\t\tmin-height: 200rpx;\r\n\t\tbackground: #fafafa;\r\n\t\tborder-radius: 8rpx;\r\n\t\tpadding: 20rpx 24rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: $text-primary;\r\n\t\tbox-sizing: border-box;\r\n\t\tborder: 1rpx solid $border-color;\r\n\t\tline-height: 1.6;\r\n\t\ttransition: all 0.3s ease;\r\n\r\n\t\t&::placeholder {\r\n\t\t\tcolor: $text-light;\r\n\t\t}\r\n\t}\r\n\r\n\t.char-count {\r\n\t\tmargin-top: 12rpx;\r\n\t\ttext-align: right;\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: $text-light;\r\n\t}\r\n\r\n\t.tags-container {\r\n\t\tdisplay: flex;\r\n\t\tflex-wrap: wrap;\r\n\t\tgap: 20rpx;\r\n\t\tmargin-top: 12rpx;\r\n\r\n\t\t.tag-item {\r\n\t\t\tmargin: 0;\r\n\t\t\tcursor: pointer;\r\n\t\t\ttransition: all 0.3s ease;\r\n\t\t}\r\n\t}\r\n\r\n\t.tip-text {\r\n\t\tmargin-top: 12rpx;\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: $text-light;\r\n\t\tline-height: 1.5;\r\n\t}\r\n\r\n\t.submit-btn {\r\n\t\tmargin-top: 60rpx;\r\n\t\twidth: 100%;\r\n\t\theight: 100rpx;\r\n\t\tbackground: linear-gradient(135deg, $primary-color 0%, #E6A33D 100%);\r\n\t\tborder: none;\r\n\t\tborder-radius: 50rpx;\r\n\t\tfont-size: 34rpx;\r\n\t\tfont-weight: 600;\r\n\t\tcolor: $white;\r\n\t\tbox-shadow: 0 8rpx 30rpx rgba(252, 184, 87, 0.3);\r\n\t\ttransition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\r\n\t\t&:active {\r\n\t\t\ttransform: scale(0.98);\r\n\t\t\topacity: 0.9;\r\n\t\t}\r\n\t}\r\n\r\n\t// uni-forms 样式覆盖\r\n\t:deep(.uni-forms-item) {\r\n\t\tmargin-bottom: 40rpx;\r\n\t}\r\n\r\n\t:deep(.uni-forms-item__label) {\r\n\t\tfont-size: 30rpx;\r\n\t\tfont-weight: 500;\r\n\t\tcolor: $text-primary;\r\n\t\tmargin-bottom: 16rpx;\r\n\t}\r\n</style>","import MiniProgramPage from 'C:/Users/House/Desktop/graduation-project/campus_activity/pages/user/createClub/createClub.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","reactive","uni","uniCloud","convertCloudPath","apiCreateClub"],"mappings":"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"}