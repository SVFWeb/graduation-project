{"version":3,"file":"clubDetails.js","sources":["pages/clubList/clubDetails/clubDetails.vue","D:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY2x1Ykxpc3QvY2x1YkRldGFpbHMvY2x1YkRldGFpbHMudnVl"],"sourcesContent":["<template>\r\n\t<view class=\"clubDetails container\">\r\n\t\t<!-- 社团基本信息 -->\r\n\t\t<view class=\"clubDetails_info\">\r\n\t\t\t<view class=\"title\">{{ clubInfo.name }}</view>\r\n\t\t\t<view class=\"id\">#ID:{{ clubInfo.id }}</view>\r\n\t\t\t<view class=\"btn\" @click=\"onShowDialog\">加入社团</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 社团成员 -->\r\n\t\t<view class=\"clubDetails_member\">\r\n\t\t\t<view class=\"title\">社团成员</view>\r\n\t\t\t<view class=\"text\">当前社团共有{{ clubInfo.memberCount }}位成员 <view class=\"details\" @click=\"onCheckUserList\">查看\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t</view>\r\n\r\n\t\t<!-- 社团简介 -->\r\n\t\t<view class=\"clubDatails_info\">\r\n\t\t\t<view class=\"title\">社团简介</view>\r\n\t\t\t<view class=\"text\">{{ clubInfo.description }}</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 社团活动 -->\r\n\t\t<view class=\"clubDatails_activity\">\r\n\t\t\t<view class=\"title\">社团活动</view>\r\n\t\t\t<view class=\"activity_list\">\r\n\t\t\t\t<com-activity-item v-if=\"activityList.length!=0\" v-for=\"item in activityList\" :activiyInfo=\"item\"></com-activity-item>\r\n\t\t\t\t<view>社团暂无活动</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n\r\n\t<!-- 提示窗示例 -->\r\n\t<uni-popup ref=\"alertDialog\" type=\"dialog\">\r\n\t\t<uni-popup-dialog type=\"info\" confirmText=\"加入\" cancelText=\"取消\" content=\"是否确认加入该社团\" @confirm=\"onJoinClub\" />\r\n\t</uni-popup>\r\n\r\n\r\n\t<uni-drawer ref=\"showRight\" mode=\"right\" :width=\"300\">\r\n\t\t<view class=\"scroll-view\">\r\n\t\t\t<scroll-view class=\"scroll-view-box\" scroll-y>\r\n\t\t\t\t<uni-list>\r\n\t\t\t\t\t<uni-list-item clickable style=\"height: 170rpx;\" v-for=\"item in userList\" :key=\"item.userId\"\r\n\t\t\t\t\t\t:title=\"item.user.realName\"\r\n\t\t\t\t\t\t:note=\"item.user.schoolName+item.user.collegeName+item.user.className\"\r\n\t\t\t\t\t\t:thumb=\"item.user.avatarUrl\" thumb-size=\"lg\" @click=\"onShowSettingManagerDialog(item.userId)\">\r\n\t\t\t\t\t\t<!-- 自定义 footer-->\r\n\t\t\t\t\t\t<template v-slot:footer>\r\n\t\t\t\t\t\t\t<uni-tag class=\"tag\" v-if=\"item.isManager\" text=\"管理\" type=\"error\" />\r\n\t\t\t\t\t\t\t<uni-tag class=\"tag\" v-else text=\"成员\" type=\"primary\" />\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</uni-list-item>\r\n\t\t\t\t</uni-list>\r\n\t\t\t</scroll-view>\r\n\t\t</view>\r\n\t</uni-drawer>\r\n\r\n\t<uni-popup  ref=\"settingManagerDialog\" type=\"dialog\">\r\n\t\t<uni-popup-dialog type=\"info\" confirmText=\"设置\" cancelText=\"取消\" content=\"是否设置该成员为管理员\"\r\n\t\t\t@confirm=\"settingManager\" />\r\n\t</uni-popup>\r\n\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tonLoad\r\n\t} from '@dcloudio/uni-app'\r\n\timport comActivityItem from '@/components/com-activity-item/com-activity-item.vue';\r\n\timport {\r\n\t\tref,\r\n\t\tdefineProps,\n\t\tonMounted\r\n\t} from 'vue';\r\n\timport {\r\n\t\tapiJoinClub,\r\n\t\tapiGetJoinClubUserList,\r\n\t\tapiSettingClubManager\r\n\t} from '@/api/club/index.js'\r\n\timport { apiGetClubActivity } from '@/api/activity/index.js'\r\n\r\n\tconst props = defineProps({\r\n\t\tinfo: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: ''\r\n\t\t}\r\n\t})\r\n\r\n\tconst alertDialog = ref(null)\r\n\tconst settingManagerDialog = ref(null)\r\n\tconst showRight = ref(null)\r\n\tconst activityList=ref([])\r\n\tconst clubInfo = ref([])\r\n\tconst userList = ref([])\r\n\tconst userInfo = ref(uni.getStorageSync('userInfo'))\r\n\tconst settingManagerUserid = ref('')\r\n\r\n\tfunction onShowDialog() {\r\n\t\talertDialog.value?.open()\r\n\t}\r\n\r\n\tasync function onJoinClub() {\r\n\t\tlet res = await apiJoinClub({\r\n\t\t\tclubId: clubInfo.value.id,\r\n\t\t\tuserId: userInfo.value.id\r\n\t\t})\r\n\r\n\t\tif (res.code == 200) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ticon: 'success',\r\n\t\t\t\ttitle: res.message\r\n\t\t\t})\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tsetTimeout(()=>{\r\n\t\t\t\tuni.reLaunch({\r\n\t\t\t\t\turl:'/pages/clubList/clubList'\r\n\t\t\t\t})\r\n\t\t\t},1500)\r\n\t\t}\r\n\t}\r\n\r\n\tasync function getJoinClubUserList() {\r\n\t\tlet res = await apiGetJoinClubUserList(clubInfo.value.id)\r\n\t\tif (res.code == 200) {\r\n\t\t\tuserList.value = res.data.items\r\n\t\t}\r\n\t}\r\n\r\n\tfunction onShowSettingManagerDialog(id) {\r\n\t\tsettingManagerUserid.value = id\r\n\t\tsettingManagerDialog.value?.open()\r\n\t\tshowRight.value?.close()\r\n\t}\r\n\r\n\tasync function settingManager() {\r\n\t\tlet res = await apiSettingClubManager({\r\n\t\t\tclubId: clubInfo.value.id,\r\n\t\t\tuserId: settingManagerUserid.value,\r\n\t\t\tisManager: true\r\n\t\t})\r\n\r\n\t\tif (res.code == 200) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ticon: 'success',\r\n\t\t\t\ttitle: res.message\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\t\r\n\tasync function getClubActivity(){\r\n\t\tlet res= await apiGetClubActivity(clubInfo.value.id)\r\n\t\tif (res.code == 200) {\r\n\t\t\tactivityList.value= res.data.page.records\r\n\t\t}\r\n\t}\r\n\r\n\tfunction onCheckUserList() {\r\n\t\tshowRight.value?.open()\r\n\t\tgetJoinClubUserList()\r\n\t}\r\n\r\n\tonLoad((e) => {\r\n\t\t// 兼容：优先使用路由参数，其次使用组件 props 传入的 info，避免 H5 模式下出现多余属性警告\r\n\t\tconst rawInfo = (e && e.info) || props.info\r\n\t\tif (rawInfo) {\r\n\t\t\tclubInfo.value = JSON.parse(decodeURIComponent(rawInfo))\r\n\t\t}\r\n\t})\r\n\t\r\n\tonMounted(()=>{\r\n\t\tgetClubActivity()\r\n\t})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t.clubDetails {\r\n\r\n\t\t// 公共样式\r\n\t\t.title {\r\n\t\t\tfont-size: 40rpx;\r\n\t\t\tfont-weight: 500;\r\n\t\t\tcolor: #333;\r\n\t\t\tmargin-bottom: 50rpx;\r\n\t\t}\r\n\r\n\t\t.text {\r\n\t\t\tfont-size: 28rpx;\r\n\t\t\tcolor: #666;\r\n\t\t\tline-height: 1.6;\r\n\t\t}\r\n\r\n\t\t// 社团信息区块\r\n\t\t.clubDetails_info {\r\n\t\t\tmargin-bottom: 60rpx;\r\n\t\t\tpadding-bottom: 50rpx;\r\n\t\t\tborder-bottom: 1rpx solid #f0f0f0;\r\n\r\n\t\t\t.title {\r\n\t\t\t\tfont-size: 44rpx;\r\n\t\t\t\tcolor: #1a1a1a;\r\n\t\t\t\tmargin-bottom: 30rpx;\r\n\t\t\t}\r\n\r\n\t\t\t.id {\r\n\t\t\t\tfont-size: 26rpx;\r\n\t\t\t\tcolor: #999;\r\n\t\t\t\tmargin-bottom: 40rpx;\r\n\t\t\t}\r\n\r\n\t\t\t.btn {\r\n\t\t\t\tpadding: 16rpx 32rpx;\r\n\t\t\t\tdisplay: inline-block;\r\n\t\t\t\tcolor: #fff;\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tbackground: linear-gradient(135deg, #0083F4, #0066CC);\r\n\t\t\t\tborder-radius: 50rpx;\r\n\t\t\t\tbox-shadow: 0 4rpx 12rpx rgba(0, 131, 244, 0.3);\r\n\t\t\t\ttransition: all 0.3s ease;\r\n\r\n\t\t\t\t&:active {\r\n\t\t\t\t\ttransform: scale(0.98);\r\n\t\t\t\t\tbox-shadow: 0 2rpx 8rpx rgba(0, 131, 244, 0.4);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// 社团成员区块\r\n\t\t.clubDetails_member {\r\n\t\t\tmargin-bottom: 90rpx;\r\n\t\t\tborder-bottom: 1rpx solid #f0f0f0;\r\n\r\n\t\t\t.text {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tjustify-content: space-between;\r\n\t\t\t\tmargin-bottom: 45rpx;\r\n\t\t\t\tfont-size: 30rpx;\r\n\t\t\t\tcolor: #333;\r\n\t\t\t}\r\n\r\n\t\t\t.details {\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tcolor: #0083F4;\r\n\t\t\t\tfont-weight: 500;\r\n\t\t\t\tdisplay: inline-block;\r\n\t\t\t\tpadding: 8rpx 16rpx;\r\n\t\t\t\tborder-radius: 8rpx;\r\n\t\t\t\tbackground-color: rgba(0, 131, 244, 0.1);\r\n\r\n\t\t\t\t&:active {\r\n\t\t\t\t\tbackground-color: rgba(0, 131, 244, 0.2);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\r\n\t\t}\r\n\r\n\t\t// 社团简介区块\r\n\t\t.clubDatails_info {\r\n\t\t\tmargin-bottom: 90rpx;\r\n\t\t\tpadding-bottom: 50rpx;\r\n\t\t\tborder-bottom: 1rpx solid #f0f0f0;\r\n\r\n\t\t\t.text {\r\n\t\t\t\tbackground: linear-gradient(135deg, #f8f9fa, #e9ecef);\r\n\t\t\t\tpadding: 40rpx;\r\n\t\t\t\tborder-radius: 20rpx;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// 社团活动区块\r\n\t\t.clubDatails_activity {\r\n\t\t\t.activity_list {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-wrap: wrap;\r\n\t\t\t\talign-items: stretch;\r\n\t\t\t\tjustify-content: space-between;\r\n\r\n\t\t\t\t// 为活动项添加统一的卡片效果\r\n\t\t\t\t::v-deep .activity-item {\r\n\t\t\t\t\tborder-radius: 20rpx;\r\n\t\t\t\t\toverflow: hidden;\r\n\t\t\t\t\tbox-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.08);\r\n\t\t\t\t\ttransition: all 0.3s ease;\r\n\r\n\t\t\t\t\t&:active {\r\n\t\t\t\t\t\ttransform: translateY(-4rpx);\r\n\t\t\t\t\t\tbox-shadow: 0 8rpx 30rpx rgba(0, 0, 0, 0.12);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// 区块通用样式\r\n\t\t.clubDetails_member,\r\n\t\t.clubDatails_info,\r\n\t\t.clubDatails_activity {\r\n\t\t\t.title {\r\n\t\t\t\tposition: relative;\r\n\t\t\t\tpadding-left: 20rpx;\r\n\r\n\t\t\t\t&::before {\r\n\t\t\t\t\tcontent: '';\r\n\t\t\t\t\tposition: absolute;\r\n\t\t\t\t\tleft: 0;\r\n\t\t\t\t\ttop: 50%;\r\n\t\t\t\t\ttransform: translateY(-50%);\r\n\t\t\t\t\twidth: 8rpx;\r\n\t\t\t\t\theight: 32rpx;\r\n\t\t\t\t\tbackground: linear-gradient(135deg, #0083F4, #00A3FF);\r\n\t\t\t\t\tborder-radius: 4rpx;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t.scroll-view {\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\t/* #endif */\r\n\t\tflex: 1\r\n\t}\r\n\r\n\t// 处理抽屉内容滚动\r\n\t.scroll-view-box {\r\n\t\tflex: 1;\r\n\t\tposition: absolute;\r\n\t\ttop: 0;\r\n\t\tright: 0;\r\n\t\tbottom: 0;\r\n\t\tleft: 0;\r\n\r\n\t\t.info-content {\r\n\t\t\tpadding: 5px 15px;\r\n\t\t}\r\n\t}\r\n\r\n\t.tag {\r\n\t\tmargin-top: 40rpx;\r\n\t\theight: 30rpx;\r\n\t\ttext-align: center;\r\n\t\tline-height: 30rpx;\r\n\t}\r\n</style>","import MiniProgramPage from 'C:/Users/House/Desktop/graduation-project/campus_activity/pages/clubList/clubDetails/clubDetails.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","apiJoinClub","apiGetJoinClubUserList","apiSettingClubManager","apiGetClubActivity","onLoad","onMounted"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAsEC,MAAM,kBAAkB,MAAW;;;;;;;;;;AAanC,UAAM,QAAQ;AAOd,UAAM,cAAcA,cAAG,IAAC,IAAI;AAC5B,UAAM,uBAAuBA,cAAG,IAAC,IAAI;AACrC,UAAM,YAAYA,cAAG,IAAC,IAAI;AAC1B,UAAM,eAAaA,cAAG,IAAC,EAAE;AACzB,UAAM,WAAWA,cAAG,IAAC,EAAE;AACvB,UAAM,WAAWA,cAAG,IAAC,EAAE;AACvB,UAAM,WAAWA,cAAG,IAACC,cAAG,MAAC,eAAe,UAAU,CAAC;AACnD,UAAM,uBAAuBD,cAAG,IAAC,EAAE;AAEnC,aAAS,eAAe;;AACvB,wBAAY,UAAZ,mBAAmB;AAAA,IACnB;AAED,mBAAe,aAAa;AAC3B,UAAI,MAAM,MAAME,2BAAY;AAAA,QAC3B,QAAQ,SAAS,MAAM;AAAA,QACvB,QAAQ,SAAS,MAAM;AAAA,MAC1B,CAAG;AAED,UAAI,IAAI,QAAQ,KAAK;AACpBD,sBAAAA,MAAI,UAAU;AAAA,UACb,MAAM;AAAA,UACN,OAAO,IAAI;AAAA,QACf,CAAI;AAGD,mBAAW,MAAI;AACdA,wBAAAA,MAAI,SAAS;AAAA,YACZ,KAAI;AAAA,UACT,CAAK;AAAA,QACD,GAAC,IAAI;AAAA,MACN;AAAA,IACD;AAED,mBAAe,sBAAsB;AACpC,UAAI,MAAM,MAAME,eAAAA,uBAAuB,SAAS,MAAM,EAAE;AACxD,UAAI,IAAI,QAAQ,KAAK;AACpB,iBAAS,QAAQ,IAAI,KAAK;AAAA,MAC1B;AAAA,IACD;AAED,aAAS,2BAA2B,IAAI;;AACvC,2BAAqB,QAAQ;AAC7B,iCAAqB,UAArB,mBAA4B;AAC5B,sBAAU,UAAV,mBAAiB;AAAA,IACjB;AAED,mBAAe,iBAAiB;AAC/B,UAAI,MAAM,MAAMC,qCAAsB;AAAA,QACrC,QAAQ,SAAS,MAAM;AAAA,QACvB,QAAQ,qBAAqB;AAAA,QAC7B,WAAW;AAAA,MACd,CAAG;AAED,UAAI,IAAI,QAAQ,KAAK;AACpBH,sBAAAA,MAAI,UAAU;AAAA,UACb,MAAM;AAAA,UACN,OAAO,IAAI;AAAA,QACf,CAAI;AAAA,MACD;AAAA,IACD;AAED,mBAAe,kBAAiB;AAC/B,UAAI,MAAK,MAAMI,mBAAAA,mBAAmB,SAAS,MAAM,EAAE;AACnD,UAAI,IAAI,QAAQ,KAAK;AACpB,qBAAa,QAAO,IAAI,KAAK,KAAK;AAAA,MAClC;AAAA,IACD;AAED,aAAS,kBAAkB;;AAC1B,sBAAU,UAAV,mBAAiB;AACjB,0BAAqB;AAAA,IACrB;AAEDC,kBAAM,OAAC,CAAC,MAAM;AAEb,YAAM,UAAW,KAAK,EAAE,QAAS,MAAM;AACvC,UAAI,SAAS;AACZ,iBAAS,QAAQ,KAAK,MAAM,mBAAmB,OAAO,CAAC;AAAA,MACvD;AAAA,IACH,CAAE;AAEDC,kBAAAA,UAAU,MAAI;AACb,sBAAiB;AAAA,IACnB,CAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7KF,GAAG,WAAW,eAAe;"}