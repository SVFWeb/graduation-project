{"version":3,"file":"app.js","sources":["App.vue","main.js"],"sourcesContent":["<script >\r\n\texport default {\r\n\t\tonLaunch: function() {\r\n\t\t\tconsole.log('App Launch')\r\n\t\t},\r\n\t\tonShow: function() {\r\n\t\t\tconsole.log('App Show')\r\n\t\t},\r\n\t\tonHide: function() {\r\n\t\t\tconsole.log('App Hide')\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\tview{\r\n\t\tbox-sizing: border-box;\r\n\t}\r\n\t\r\n\t.safety_area{\r\n\t\twidth: 100vw;\r\n\t\theight: env(safe-area-inset-bottom);\r\n\t}\r\n\t\r\n\t.container{\r\n\t\tpadding: 20rpx 24rpx;\r\n\t\tmin-height: 100vh;\r\n\t}\r\n</style>\r\n","import App from './App'\n\n// #ifndef VUE3\nimport Vue from 'vue'\nimport './uni.promisify.adaptor'\nVue.config.productionTip = false\nApp.mpType = 'app'\nconst app = new Vue({\n\t...App\n})\napp.$mount()\n// #endif\n\n// #ifdef VUE3\nimport {\n\tcreateSSRApp\n} from 'vue'\nexport function createApp() {\n\tconst app = createSSRApp(App)\n\treturn {\n\t\tapp\n\t}\n}\n// #endif\n\n// 需要权限的api\nconst routeTypes = ['navigateTo', 'redirectTo', 'switchTab', 'reLaunch', 'navigateBack'];\n// 不需要权限的页面\nconst routeNoControl=['/pages/index/index','/pages/system/login/login','/pages/system/registration/registration','/pages/activity/activity','/pages/user/user','/pages/system/userInfo/userInfo']\n\n// 为每个api添加拦截器\nrouteTypes.forEach(item => {\n\tuni.addInterceptor(item, {\n\t\tinvoke(option) {\n\t\t\tconst token = uni.getStorageSync('token')\n\t\t\tconst profileCompleted = uni.getStorageSync('profileCompleted')\n\t\t\t\n\t\t\t// 检查是否登录\n\t\t\tif (!token && !routeNoControl.includes(option.url)) {\n\t\t\t\tuni.reLaunch({\n\t\t\t\t\turl: '/pages/system/login/login'\n\t\t\t\t})\n\t\t\t\treturn false\n\t\t\t}\n\t\t\t\n\t\t\t// 如果已登录但未完善个人信息\n\t\t\tif (token && !profileCompleted) {\n\t\t\t\t// 允许访问的页面：登录、注册、完善信息\n\t\t\t\tconst allowedPages = ['/pages/system/login/login', '/pages/system/registration/registration', '/pages/system/userInfo/userInfo']\n\t\t\t\t// 如果是switchTab到首页，允许进入（首页会自己检查并跳转）\n\t\t\t\tif (item === 'switchTab' && option.url === '/pages/index/index') {\n\t\t\t\t\treturn true\n\t\t\t\t}\n\t\t\t\t// 如果访问的不是允许的页面，跳转到完善信息页面\n\t\t\t\tif (!allowedPages.includes(option.url)) {\n\t\t\t\t\tuni.redirectTo({\n\t\t\t\t\t\turl: '/pages/system/userInfo/userInfo'\n\t\t\t\t\t})\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t})\n});\n"],"names":["uni","createSSRApp","App"],"mappings":";;;;;;;;;;;;;;;;;;;;AACC,MAAK,YAAU;AAAA,EACd,UAAU,WAAW;AACpBA,kBAAAA,MAAA,MAAA,OAAA,gBAAY,YAAY;AAAA,EACxB;AAAA,EACD,QAAQ,WAAW;AAClBA,kBAAAA,MAAY,MAAA,OAAA,gBAAA,UAAU;AAAA,EACtB;AAAA,EACD,QAAQ,WAAW;AAClBA,kBAAAA,MAAY,MAAA,OAAA,iBAAA,UAAU;AAAA,EACvB;AACD;ACMM,SAAS,YAAY;AAC3B,QAAM,MAAMC,cAAY,aAACC,SAAG;AAC5B,SAAO;AAAA,IACN;AAAA,EACA;AACF;AAIA,MAAM,aAAa,CAAC,cAAc,cAAc,aAAa,YAAY,cAAc;AAEvF,MAAM,iBAAe,CAAC,sBAAqB,6BAA4B,2CAA0C,4BAA2B,oBAAmB,iCAAiC;AAGhM,WAAW,QAAQ,UAAQ;AAC1BF,gBAAG,MAAC,eAAe,MAAM;AAAA,IACxB,OAAO,QAAQ;AACd,YAAM,QAAQA,cAAAA,MAAI,eAAe,OAAO;AACxC,YAAM,mBAAmBA,cAAAA,MAAI,eAAe,kBAAkB;AAG9D,UAAI,CAAC,SAAS,CAAC,eAAe,SAAS,OAAO,GAAG,GAAG;AACnDA,sBAAAA,MAAI,SAAS;AAAA,UACZ,KAAK;AAAA,QACV,CAAK;AACD,eAAO;AAAA,MACP;AAGD,UAAI,SAAS,CAAC,kBAAkB;AAE/B,cAAM,eAAe,CAAC,6BAA6B,2CAA2C,iCAAiC;AAE/H,YAAI,SAAS,eAAe,OAAO,QAAQ,sBAAsB;AAChE,iBAAO;AAAA,QACP;AAED,YAAI,CAAC,aAAa,SAAS,OAAO,GAAG,GAAG;AACvCA,wBAAAA,MAAI,WAAW;AAAA,YACd,KAAK;AAAA,UACX,CAAM;AACD,iBAAO;AAAA,QACP;AAAA,MACD;AAAA,IACD;AAAA,EACH,CAAE;AACF,CAAC;;;"}